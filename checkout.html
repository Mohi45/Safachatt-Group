<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Checkout - Jyoti's Cosmetic House</title>
    <link rel="stylesheet" href="css/base.css">
    <link rel="stylesheet" href="css/navbar.css">
    <link rel="stylesheet" href="css/header.css">
    <link rel="stylesheet" href="css/footer.css">
    <link rel="stylesheet" href="css/checkout.css">
</head>

<body>
    <nav class="navbar">
        <div class="logo">Safachatt Group</div>
        <button class="menu-toggle" aria-label="Toggle menu">‚ò∞</button>
        <ul class="nav-links">
            <li><a href="index.html#home">Home</a></li>
            <li><a href="index.html#products">Products</a></li>
            <li><a href="index.html#contact">Contact</a></li>
        </ul>
    </nav>

    <div class="checkout-container">
        <h2 class="checkout-title">Checkout Summary</h2>
        <div class="order-id">Order ID: <span id="orderId"></span></div>

        <div class="checkout-items"></div>

        <div class="checkout-summary">
            <p><strong>Total Amount:</strong> <span id="totalAmount">‚Çπ0</span></p>
            <p style="color: green; font-weight: 600;">üéâ You saved <span id="totalSaved">‚Çπ0</span> on this order!</p>
        </div>

        <div class="upi-section">
            <h3>Pay via UPI</h3>
            <p>UPI ID: <strong>9625290733@ybl</strong></p>
            <img src="img/upi-qr.png" alt="UPI QR Code" style="max-width:160px;">
        </div>

        <label for="checkoutAddress">Enter Delivery Address:</label>
        <textarea id="checkoutAddress" placeholder="Type your full address here" rows="3" required></textarea>

        <div class="action-buttons">
            <button class="btn" id="continueShopping">‚Üê Continue Shopping</button>
            <button class="btn" id="confirmWhatsApp">Place Order via WhatsApp</button>
        </div>
    </div>

    <footer>
        <p style="text-align:center; margin-top:40px; color:#888;">
            ¬© 2025 Jyoti's Cosmetic House. All Rights Reserved.
        </p>
    </footer>

    <script>
        document.addEventListener("DOMContentLoaded", () => {
            const container = document.querySelector(".checkout-items");
            const totalEl = document.getElementById("totalAmount");
            const savedEl = document.getElementById("totalSaved");
            const confirmBtn = document.getElementById("confirmWhatsApp");
            const continueBtn = document.getElementById("continueShopping");
            const orderIdEl = document.getElementById("orderId");

            // üÜî Auto-generate Order ID
            const orderId = "ORD" + Date.now().toString().slice(-6);
            orderIdEl.textContent = orderId;

            // üõí Load cart
            const cart = JSON.parse(localStorage.getItem("cartData")) || [];
            let total = 0;
            let totalSaved = 0;

            if (cart.length === 0) {
                container.innerHTML = "<p>No items in cart. Go back and select products.</p>";
                confirmBtn.disabled = true;
                return;
            }

            // üßÆ Populate items
            cart.forEach(item => {
                const originalPrice = item.price;
                const discount = item.discount || 0;
                const discountedPrice = (originalPrice * (1 - discount / 100)).toFixed(0);
                const subtotal = discountedPrice * item.qty;
                const savedAmount = (originalPrice - discountedPrice) * item.qty;

                total += subtotal;
                totalSaved += savedAmount;

                container.innerHTML += `
          <div class="checkout-item">
            <img src="${item.img}" alt="${item.name}">
            <div>
              <h3>${item.name}</h3>
              <p>Qty: ${item.qty}</p>
              <p>
                ‚Çπ${discountedPrice} 
                ${discount > 0 ? `<del style="color:gray;">‚Çπ${originalPrice}</del> <span style="color:green;">(${discount}% OFF)</span>` : ""}
              </p>
              ${discount > 0 ? `<p class="save-msg">You save ‚Çπ${savedAmount.toFixed(0)}!</p>` : ""}
            </div>
            <div class="item-total">‚Çπ${subtotal.toFixed(0)}</div>
          </div>
        `;
            });

            totalEl.textContent = `‚Çπ${total.toFixed(0)}`;
            savedEl.textContent = `‚Çπ${totalSaved.toFixed(0)}`;

            // üîÅ Continue Shopping (keep cart data)
            continueBtn.addEventListener("click", () => {
                window.location.href = "index.html";
            });

            // ‚úÖ Place Order via WhatsApp
            confirmBtn.addEventListener("click", () => {
                const address = document.getElementById("checkoutAddress").value.trim();
                if (!address) {
                    alert("Please enter your delivery address.");
                    return;
                }

                const phoneNumber = "919625290733";
                let message = `üßæ *Order Confirmation*%0AOrder ID: ${orderId}%0A%0A`;

                cart.forEach(item => {
                    const price = (item.price * (1 - (item.discount || 0) / 100)).toFixed(0);
                    message += `${item.qty} √ó ${item.name} = ‚Çπ${(item.qty * price).toFixed(0)}%0A`;
                });

                message += `%0Aüí∞ Total: ‚Çπ${total.toFixed(0)}%0Aüéâ You Saved: ‚Çπ${totalSaved.toFixed(0)}%0A%0Aüìç Address: ${encodeURIComponent(address)}%0A%0Aüí≥ Payment via UPI: 9625290733@ybl%0A%0Aüì∏ *Please share the payment screenshot as well.*%0A%0AThank you for shopping with *Jyoti‚Äôs Cosmetic House!* üå∏`;


                window.open(`https://wa.me/${phoneNumber}?text=${message}`, "_blank");
            });
        });
    </script>
</body>

</html>